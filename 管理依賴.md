# 管理依賴？

問題

1. 是否有遇到「想要重複利用的腳本」，卻因為依賴無法搬到另一個專案？
2. 是否有遇到「想要更新舊的腳本」，卻因為依賴不能更新功能？
3. 是否有遇到「想要寫更好的方法」，卻因為依賴不能再寫一次？

解套方法

- 開始使用`AssemblyDefinition`！
  讓新的腳本限制自己能依賴誰，而不是全部！
- 讓舊的腳本決定被誰依賴，不再依賴外部完成自己的功能！

重要概念
- 當腳本增加引用，就會減少他們重複可利用性。

## 原理

### 介紹 AssemblyDefinition

`UnityEditor`在建置輸出或稱`Build`的時候，它會把所有的腳本編譯成為一個龐大的`.dll`
這個`.dll`檔案就是我們所謂的`Assembly`中文叫做`組件`。遊戲的運行都靠這個組件提供的功能與定義。
當我們使用`AssemblyDefinition`時，可以命令`UnityEditor`對某些腳本獨立製作出`.dll`。
如此一來，我們可以確保獨立製作出來的`.dll`不會胡亂參考別的地方的腳本，也增加了這個獨立製作出的`.dll`重複利用性。

### 思考方式

![一張關於 Assembly Definition 怎麼使用的架構圖](assembly.png)

左邊的`.dll`是遊戲主要的`.dll`，沒有`AssemblyDefinition`的，都位於此。
而它透過箭頭關係依賴`Title.dll`、`LogicalGame.dll`、`Result.dll`，
就是三個透過場景劃分出來的三個`.dll`腳本組件。它們分別都是一個獨立的遊戲場景，
而且當中場景用的腳本都被完整獨立出來了！最後它們共同需要的功能，
透過箭頭依賴著`Afs.Core.dll`就是不分場景的共同核心功能！如此一來場景之間沒有關係，
都可以獨立作業，而且共通的功能也可以被下一個場景利用。更確保了，
核心功能不是跟其他腳本產生依賴的存在關係，可以被挪出再利用。

### 使用手冊

1. `AssemblyDefinition`是一個檔案
    1. 在Project視窗目標資料夾下按下右鍵，選擇Create>Assembly Definition。
    2. 命名你要的名稱
2. `AssemblyDefinition`作用在與同一層資料夾或以下的檔案位於子資料夾
3. `AssemblyDefinition`作用的檔案不能參考沒有`AssemblyDefinition`作用的檔案

#### 情境

    📁Assets
        📁ABs
            📁Title
            🎬Title.unity
                📁Scripts
                    🧱Title.asmdef
                    📃Manager.cs
                    📃Def.cs
                    📁UI
                        📃ReelView.cs
                        📃MenuView.cs
                📁Textures
                    🖼img-title-new-game.png
                    🖼img-title-load-game.png
                    🖼img-title-settings.png
            📁LogicalGame
            🎬LogicalGame.unity
                📁Scripts
                    🧱LogicalGame.asmdef
                    📃Manager.cs
                    📃Def.cs
                    📁UI
                        📃PlayAreaView.cs
                        📃ShipView.cs
                📁Textures
                    🖼img-logical-game-ships.png
                    🖼img-logical-game-rock.png
                    🖼img-logical-game-aimmy.png
            📁Result
            🎬Result.unity
                📁Scripts
                    🧱Result.asmdef
                    📃Manager.cs
                    📃Def.cs
                    📁UI
                        📃Page1View.cs
                        📃Page2View.cs
                        📃Page3View.cs
                📁Textures
                    🖼img-result-page1-bg.png
                    🖼img-result-page2-bg.png
                    🖼img-result-page3-bg.png
                    🖼img-result-octagon.png
                    🖼img-result-details.png
                    🖼img-result-line.png